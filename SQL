-- Salary Analysis by Experience Level

SELECT experience_level, ROUND(AVG(salary_in_usd)) as avg_salary_experience
FROM salaries 
GROUP BY experience_level 
ORDER BY avg_salary_experience DESC;

-- Salary by Job Title

SELECT job_title, ROUND(AVG(salary_in_usd)) as high_avg_salary_job
FROM salaries 
GROUP BY job_title
ORDER BY high_avg_salary_job DESC
LIMIT 10;

-- Salary by Company Size & Experience Level

SELECT company_size, experience_level, ROUND(AVG(salary_in_usd)) AS avg_salary
FROM salaries
GROUP BY company_size, experience_level
ORDER BY avg_salary DESC;

-- Remote vs On-site Salary Analysis
SELECT remote_ratio, ROUND(AVG(salary_in_usd)) AS avg_salary
FROM salaries
GROUP BY remote_ratio
ORDER BY avg_salary DESC;


-- Salary By Country
SELECT company_location, ROUND(AVG(salary_in_usd)) AS avg_salary
FROM salaries
GROUP BY company_location
ORDER BY avg_salary DESC
LIMIT 10;

-- Salary Ranking By Experience
WITH ranked_salaries AS (
    SELECT 
        job_title,
        experience_level,
        salary_in_usd,
        DENSE_RANK() OVER(PARTITION BY experience_level ORDER BY salary_in_usd DESC) AS rank_salary
    FROM salaries
)
SELECT *
FROM ranked_salaries
WHERE rank_salary <= 3
ORDER BY experience_level, rank_salary;

